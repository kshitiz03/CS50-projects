{"filter":false,"title":"resize.c","tooltip":"/pset4/bmp/resize.c","undoManager":{"mark":0,"position":0,"stack":[[{"start":{"row":0,"column":0},"end":{"row":101,"column":1},"action":"insert","lines":["#include <stdio.h>","#include <stdlib.h>","","#include \"bmp.h\"","","int main(int argc, char* argv[])","{","\t\tif (argc != 4)","\t\t{","\t\t\t\tprintf(\"Usage:resize n infile outfile\\n\");","\t\t\t\treturn 1;","\t\t}","","\t\tint factor = atoi(argv[1]);","\t\tif(factor < 0 || factor > 100)","\t\t{","\t\t\t\tprintf(\"The resize factor should be a positive integer >= 100.\\n\");","\t\t\t\treturn 2;","\t\t}"," ","\t\tchar* infile = argv[2];","\t\tchar* outfile = argv[3];","","\t\tFILE* inptr = fopen(infile, \"r\");","\t\tif (inptr == NULL)","\t\t{","\t\t\t\tprintf(\"Could not open %s.\\n\", infile);","\t\t\t\treturn 3;","\t\t}","","\t\tFILE* outptr = fopen(outfile, \"w\");","\t\tif (outptr == NULL)","\t\t{","\t\t\t\tfclose(inptr);","\t\t\t\tfprintf(stderr, \"Could not create %s.\\n\", outfile);","\t\t\t\treturn 4;","\t\t}","","\t\tBITMAPFILEHEADER bf;","\t\tfread(&bf, sizeof(BITMAPFILEHEADER), 1, inptr);","","\t\tBITMAPINFOHEADER bi;","\t\tfread(&bi, sizeof(BITMAPINFOHEADER), 1, inptr);","","\t\tif (bf.bfType != 0x4d42 || bf.bfOffBits != 54 || bi.biSize != 40 || ","\t\t\t\t\t\tbi.biBitCount != 24 || bi.biCompression != 0)","\t\t{","\t\t\t\tfclose(outptr);","\t\t\t\tfclose(inptr);","\t\t\t\tfprintf(stderr, \"Unsupported file format.\\n\");","\t\t\t\treturn 4;","\t\t}","","\t\tBITMAPFILEHEADER out_bf;","\t\tBITMAPINFOHEADER out_bi;\t","\t\tout_bf = bf;","\t\tout_bi = bi;","\t\tout_bi.biWidth = bi.biWidth * factor;","\t\tout_bi.biHeight = bi.biHeight * factor;","","\t\tint in_padding =  (4 - (bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;","\t\tint out_padding =  (4 - (out_bi.biWidth * sizeof(RGBTRIPLE)) % 4) % 4;","","\t\tout_bf.bfSize = 54 + out_bi.biWidth * abs(out_bi.biHeight) * 3 + abs(out_bi.biHeight) *  out_padding;","\t\tout_bi.biSizeImage = ((((out_bi.biWidth * out_bi.biBitCount) + 31) & ~31) / 8) * abs(out_bi.biHeight);","","\t\tfwrite(&out_bf, sizeof(BITMAPFILEHEADER), 1, outptr);","","\t\tfwrite(&out_bi, sizeof(BITMAPINFOHEADER), 1, outptr);","","\t\tfor (int i = 0, biHeight = abs(bi.biHeight); i < biHeight; i++)","\t\t{","\t\t\t\tfor(int n = 0; n < factor; n++)","\t\t\t\t{","\t\t\t\t\t\tfor (int j = 0; j < bi.biWidth; j++)","\t\t\t\t\t\t{","\t\t\t\t\t\t\t\tRGBTRIPLE triple;","","\t\t\t\t\t\t\t\tfread(&triple, sizeof(RGBTRIPLE), 1, inptr);","","\t\t\t\t\t\t\t\tfor(int m = 0; m < factor; m++) ","\t\t\t\t\t\t\t\t{","\t\t\t\t\t\t\t\t\t\tfwrite(&triple, sizeof(RGBTRIPLE), 1, outptr);","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","","\t\t\t\t\t\tfseek(inptr, in_padding, SEEK_CUR);","","\t\t\t\t\t\tfor (int k = 0; k <out_padding; k++)","\t\t\t\t\t\t\t\tfputc(0x00, outptr);","","\t\t\t\t\t\tfseek(inptr, -(bi.biWidth * 3 + in_padding ), SEEK_CUR);","","\t\t\t\t}","\t\t\t\tfseek(inptr, bi.biWidth*3+in_padding, SEEK_CUR);","\t\t}","","\t\tfclose(inptr);","\t\tfclose(outptr);","","\t\treturn 0;","}"],"id":1}]]},"ace":{"folds":[],"scrolltop":1162,"scrollleft":0,"selection":{"start":{"row":101,"column":1},"end":{"row":101,"column":1},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":71,"state":"start","mode":"ace/mode/c_cpp"}},"timestamp":1457647556693,"hash":"86824d1ce138b3179095d105d992eabba1947f8b"}