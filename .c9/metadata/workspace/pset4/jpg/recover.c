{"filter":false,"title":"recover.c","tooltip":"/pset4/jpg/recover.c","undoManager":{"mark":1,"position":1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":13,"column":0},"action":"remove","lines":["/**"," * recover.c"," *"," * Computer Science 50"," * Problem Set 4"," *"," * Recovers JPEGs from a forensic image."," */","","int main(int argc, char* argv[])","{","    // TODO","}",""],"id":2}],[{"start":{"row":0,"column":0},"end":{"row":82,"column":0},"action":"insert","lines":["/**"," * recover.c"," *"," * Computer Science 50"," * Problem Set 4"," *"," * Recovers JPEGs from a forensic image."," */","#include <stdio.h>","#include <stdlib.h>","#include <stdint.h>","#include <string.h>","","","int main(void)","{","    FILE* fp = fopen(\"card.raw\", \"r\");\t","","\t\tif(fp == NULL)","\t\t{\t","\t\t\t\tfclose(fp);","\t\t\t\tfprintf(stderr, \"cardfile file didn't open.\\n\");","\t\t\t\treturn 1;","\t\t}","","\t\tuint8_t checkjpg1[4] = {0xff, 0xd8, 0xff, 0xe0};","\t\tuint8_t checkjpg2[4] = {0xff, 0xd8, 0xff, 0xe1};","","\t\t","\t\tint jpgcount = 0;","","\t\t// Open outfile indicator","\t\tint open = 0;","\t\tFILE* outp;","","\t\tuint8_t buffer[512];","\t\tuint8_t check[4];","\t\tfread(buffer, 512, 1, fp);\t","","\t\twhile(fread(buffer, 512, 1, fp) > 0)","\t\t{","\t\t\t\tfor(int i = 0; i < 4; i++)","\t\t\t\t{","\t\t\t\t\t\tcheck[i] = buffer[i];","\t\t\t\t}","","\t\t\t\tif((memcmp(checkjpg1, check, 4) == 0 ) || (memcmp(checkjpg2, check, sizeof(check)) == 0))","\t\t\t\t{","\t\t\t\t\t\tchar filename[8];","\t\t\t\t\t\tsprintf(filename, \"%03d.jpg\", jpgcount);","","\t\t\t\t\t\tif(open == 0)","\t\t\t\t\t\t{","\t\t\t\t\t\t\t\toutp = fopen(filename, \"w\");","\t\t\t\t\t\t\t\tfwrite(buffer, sizeof(buffer), 1, outp);","\t\t\t\t\t\t\t\topen = 1;","\t\t\t\t\t\t}","\t\t\t\t\t\tif(open == 1)","\t\t\t\t\t\t{","\t\t\t\t\t\t\t\tfclose(outp);","\t\t\t\t\t\t\t\toutp = fopen(filename, \"w\");","\t\t\t\t\t\t\t\tfwrite(buffer, sizeof(buffer), 1, outp);","\t\t\t\t\t\t\t\tjpgcount++;","\t\t\t\t\t\t}","\t\t\t\t}","\t\t\t\telse","\t\t\t\t{","\t\t\t\t\t\tif(open == 1)","\t\t\t\t\t\t{","\t\t\t\t\t\t\t\tfwrite(buffer, sizeof(buffer), 1, outp);","\t\t\t\t\t\t}","\t\t\t\t}","\t\t}","    ","    if(outp)","    {","      fclose(outp);","    }","","\t\tfclose(fp);","\t\treturn 0;","}",""],"id":3}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":82,"column":0},"end":{"row":82,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1457647488995,"hash":"d24111ec49044ed906cea29989c55a54ab81d97c"}